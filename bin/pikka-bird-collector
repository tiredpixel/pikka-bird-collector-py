#!/usr/bin/env python

import argparse
import logging
import os

import pikka_bird_collector.collector


parser = argparse.ArgumentParser(
    description="Pikka Bird monitoring tool Collector component.")

parser.add_argument('--log-level',
    metavar='LOG_LEVEL',
    choices=['DEBUG', 'INFO', 'WARNING', 'ERROR', 'CRITICAL'],
    default='INFO',
    help="log-level (default: INFO)")

args = parser.parse_args()


logger = logging.getLogger(str(os.getpid()))

formatter = logging.Formatter(
    '[%(asctime)s] %(levelname)s -- %(name)s: %(message)s')

ch = logging.StreamHandler()
ch.setFormatter(formatter)

logger.setLevel(args.log_level)
logger.addHandler(ch)


logger.info("Pikka Bird Collector v%(v)s" % { 'v': pikka_bird_collector.__version__ })

collector = pikka_bird_collector.collector.Collector(logger=logger)

collector.collect()
